# Huawei SUN2000 - Statusy i Alarmy Bitowe - Dokumentacja

## Opis zawartoÅ›ci

Ten dokument zawiera kompletne mapowanie rejestrÃ³w bitowych dla invertera Huawei SUN2000 z adresami Modbus, opisami poszczegÃ³lnych bitÃ³w oraz zaleceniami dotyczÄ…cymi monitorowania.

---

## ğŸ“Š REJESTRY STATUSÃ“W (STATE)

### STATE1 - Rejestr 32002 (0x7D02)
**Opis:** Podstawowe statusy pracy invertera

| Bit | Maska | Status | Opis | Priorytet |
|-----|-------|--------|------|-----------|
| 0 | 0x0001 | Standby | Tryb oczekiwania (normalny nocÄ…) | â„¹ï¸ Info |
| 1 | 0x0002 | SieÄ‡ dostÄ™pna | NapiÄ™cie sieci w normie | âœ… OK |
| 2 | 0x0004 | PoÅ‚Ä…czenie z sieciÄ… | Inverter pracuje on-grid | âœ… OK |
| 3 | 0x0008 | Tryb wyÅ‚Ä…czenia | Inverter wyÅ‚Ä…czony | âš ï¸ Uwaga |
| 4 | 0x0010 | Tryb oszczÄ™dzania energii | Niska moc wejÅ›ciowa | â„¹ï¸ Info |
| 5 | 0x0020 | Tryb eksportu energii | Oddawanie energii do sieci | âœ… OK |
| 6 | 0x0040 | Tryb synchronizacji | Synchronizacja z sieciÄ… | â„¹ï¸ Info |
| 7 | 0x0080 | Tryb pracy | Normalny tryb pracy | âœ… OK |
| 8 | 0x0100 | Tryb debugowania | Diagnostyka systemu | âš ï¸ Uwaga |
| 9 | 0x0200 | Tryb serwisowy | Serwis/konserwacja | âš ï¸ Uwaga |
| 10 | 0x0400 | Tryb aktualizacji | Aktualizacja firmware | ğŸ”„ Proces |
| 11 | 0x0800 | Tryb testowy | Testy systemu | â„¹ï¸ Info |
| 12 | 0x1000 | Tryb konfiguracji | Konfiguracja parametrÃ³w | ğŸ”§ Config |
| 13 | 0x2000 | Tryb monitorowania | Aktywne monitorowanie | â„¹ï¸ Info |
| 14 | 0x4000 | Tryb awaryjny | Stan awaryjny | ğŸš¨ Krytyczny |
| 15 | 0x8000 | Tryb offline | Brak komunikacji | ğŸš¨ Krytyczny |

### STATE2 - Rejestr 32003 (0x7D03)
**Opis:** Rozszerzone statusy systemu

| Bit | Maska | Status | Opis | Priorytet |
|-----|-------|--------|------|-----------|
| 0 | 0x0001 | MPPT1 aktywny | Pierwszy tracker pracuje | âœ… OK |
| 1 | 0x0002 | MPPT2 aktywny | Drugi tracker pracuje | âœ… OK |
| 2 | 0x0004 | Anti-islanding aktywne | Zabezpieczenie wyspy | âœ… OK |
| 3 | 0x0008 | PV izolacja OK | Rezystancja izolacji OK | âœ… OK |
| 4 | 0x0010 | Wentylator aktywny | ChÅ‚odzenie wÅ‚Ä…czone | â„¹ï¸ Info |
| 5 | 0x0020 | Temperatura OK | Normalna temperatura | âœ… OK |
| 6 | 0x0040 | AC relay zamkniÄ™te | PrzekaÅºnik AC wÅ‚Ä…czony | âœ… OK |
| 7 | 0x0080 | DC relay zamkniÄ™te | PrzekaÅºnik DC wÅ‚Ä…czony | âœ… OK |
| 8-15 | - | Zarezerwowane | NieuÅ¼ywane | - |

### STATE3 - Rejestr 32004 (0x7D04)
**Opis:** Statusy komunikacji i systemu

| Bit | Maska | Status | Opis | Priorytet |
|-----|-------|--------|------|-----------|
| 0 | 0x0001 | Komunikacja RS485 OK | ÅÄ…cznoÅ›Ä‡ lokalna OK | âœ… OK |
| 1 | 0x0002 | Komunikacja Ethernet OK | ÅÄ…cznoÅ›Ä‡ sieciowa OK | âœ… OK |
| 2 | 0x0004 | Komunikacja WiFi OK | ÅÄ…cznoÅ›Ä‡ bezprzewodowa OK | âœ… OK |
| 3 | 0x0008 | Dongle poÅ‚Ä…czony | Smart Dongle aktywny | âœ… OK |
| 4 | 0x0010 | Licznik energii OK | Komunikacja z licznikiem | âœ… OK |
| 5 | 0x0020 | Optymalizatory OK | ÅÄ…cznoÅ›Ä‡ z optymalizatorami | âœ… OK |
| 6 | 0x0040 | Cloud poÅ‚Ä…czone | ÅÄ…cznoÅ›Ä‡ z chmurÄ… Huawei | â„¹ï¸ Info |
| 7 | 0x0080 | NTP zsynchronizowany | Czas zsynchronizowany | â„¹ï¸ Info |
| 8-15 | - | Zarezerwowane | NieuÅ¼ywane | - |

---

## ğŸš¨ REJESTRY ALARMÃ“W (ALARM)

### ALARM1 - Rejestr 32008 (0x7D08)
**Opis:** Alarmy temperatury, wentylacji i podstawowe bÅ‚Ä™dy

| Bit | Maska | Alarm | Opis | Akcja | Priorytet |
|-----|-------|--------|------|--------|-----------|
| 0 | 0x0001 | Wysoka temperatura wewnÄ™trzna | >75Â°C w module gÅ‚Ã³wnym | SprawdÅº wentylacjÄ™ | ğŸš¨ Krytyczny |
| 1 | 0x0002 | Wysoka temperatura radiatora | >85Â°C na radiatorze | CzyÅ›Ä‡ radiator | ğŸš¨ Krytyczny |
| 2 | 0x0004 | Wysoka temperatura moduÅ‚u mocy | >90Â°C w module mocy | SprawdÅº obciÄ…Å¼enie | ğŸš¨ Krytyczny |
| 3 | 0x0008 | BÅ‚Ä…d wentylatora | Wentylator nie dziaÅ‚a | WymieÅ„ wentylator | ğŸš¨ Krytyczny |
| 4 | 0x0010 | BÅ‚Ä…d Phase A | Problem z fazÄ… A | SprawdÅº okablowanie | âš ï¸ WaÅ¼ny |
| 5 | 0x0020 | BÅ‚Ä…d Phase B | Problem z fazÄ… B | SprawdÅº okablowanie | âš ï¸ WaÅ¼ny |
| 6 | 0x0040 | BÅ‚Ä…d Phase C | Problem z fazÄ… C | SprawdÅº okablowanie | âš ï¸ WaÅ¼ny |
| 7 | 0x0080 | BÅ‚Ä…d SPD | PrzepiÄ™ciÃ³wka uszkodzona | WymieÅ„ SPD | âš ï¸ WaÅ¼ny |
| 8 | 0x0100 | OdwrÃ³cona polaryzacja PV1 | +/- zamienione w string 1 | Popraw poÅ‚Ä…czenia | ğŸš¨ Krytyczny |
| 9 | 0x0200 | OdwrÃ³cona polaryzacja PV2 | +/- zamienione w string 2 | Popraw poÅ‚Ä…czenia | ğŸš¨ Krytyczny |
| 10 | 0x0400 | PV1 doziemiony | String 1 ma zwarcie do ziemi | SprawdÅº izolacjÄ™ | ğŸš¨ Krytyczny |
| 11 | 0x0800 | PV2 doziemiony | String 2 ma zwarcie do ziemi | SprawdÅº izolacjÄ™ | ğŸš¨ Krytyczny |
| 12 | 0x1000 | Niska rezystancja izolacji | <1MÎ© - zagroÅ¼enie! | NATYCHMIAST sprawdÅº | ğŸš¨ Krytyczny |
| 13 | 0x2000 | BÅ‚Ä…d czujnika temperatury | Uszkodzony termometr | WymieÅ„ czujnik | âš ï¸ WaÅ¼ny |
| 14 | 0x4000 | BÅ‚Ä…d komunikacji AFCI | Problem z Arc Fault Circuit | SprawdÅº AFCI | âš ï¸ WaÅ¼ny |
| 15 | 0x8000 | BÅ‚Ä…d AFCI | Wykryto Å‚uk elektryczny | NATYCHMIAST wyÅ‚Ä…cz | ğŸš¨ Krytyczny |

### ALARM2 - Rejestr 32009 (0x7D09)
**Opis:** Alarmy czujnikÃ³w i zabezpieczeÅ„

| Bit | Maska | Alarm | Opis | Akcja | Priorytet |
|-----|-------|--------|------|--------|-----------|
| 0 | 0x0001 | BÅ‚Ä…d czujnika prÄ…du AC | Uszkodzony przetwornik | Kalibracja/wymiana | âš ï¸ WaÅ¼ny |
| 1 | 0x0002 | BÅ‚Ä…d czujnika napiÄ™cia AC | Uszkodzony przetwornik | Kalibracja/wymiana | âš ï¸ WaÅ¼ny |
| 2 | 0x0004 | BÅ‚Ä…d kalibracji prÄ…du | NieprawidÅ‚owa kalibracja | Rekalibracja | âš ï¸ WaÅ¼ny |
| 3 | 0x0008 | BÅ‚Ä…d kalibracji napiÄ™cia | NieprawidÅ‚owa kalibracja | Rekalibracja | âš ï¸ WaÅ¼ny |
| 4 | 0x0010 | BÅ‚Ä…d czujnika prÄ…du PV | Uszkodzony czujnik DC | WymieÅ„ czujnik | âš ï¸ WaÅ¼ny |
| 5 | 0x0020 | BÅ‚Ä…d czujnika napiÄ™cia PV | Uszkodzony czujnik DC | WymieÅ„ czujnik | âš ï¸ WaÅ¼ny |
| 6 | 0x0040 | BÅ‚Ä…d czujnika prÄ…du wyjÅ›cia | Problem na wyjÅ›ciu | SprawdÅº wyjÅ›cie | âš ï¸ WaÅ¼ny |
| 7 | 0x0080 | BÅ‚Ä…d czujnika napiÄ™cia wyjÅ›cia | Problem na wyjÅ›ciu | SprawdÅº wyjÅ›cie | âš ï¸ WaÅ¼ny |
| 8 | 0x0100 | BÅ‚Ä…d czujnika prÄ…du sieci | Problem pomiaru sieci | SprawdÅº przyÅ‚Ä…cze | âš ï¸ WaÅ¼ny |
| 9 | 0x0200 | BÅ‚Ä…d czujnika napiÄ™cia sieci | Problem pomiaru sieci | SprawdÅº przyÅ‚Ä…cze | âš ï¸ WaÅ¼ny |
| 10 | 0x0400 | PrÄ…d upÅ‚ywu | Wykryto prÄ…d upÅ‚ywu | SprawdÅº izolacjÄ™ | ğŸš¨ Krytyczny |
| 11 | 0x0800 | Zabezpieczenie odwrotne | OdwrÃ³cony kierunek energii | SprawdÅº fazowanie | âš ï¸ WaÅ¼ny |
| 12 | 0x1000 | Zabezpieczenie impedancji | NieprawidÅ‚owa impedancja | SprawdÅº sieÄ‡ | âš ï¸ WaÅ¼ny |
| 13 | 0x2000 | Zabezpieczenie napiÄ™cia | NapiÄ™cie poza normÄ… | SprawdÅº sieÄ‡ | ğŸš¨ Krytyczny |
| 14 | 0x4000 | Zabezpieczenie czÄ™stotliwoÅ›ci | CzÄ™stotliwoÅ›Ä‡ poza normÄ… | SprawdÅº sieÄ‡ | ğŸš¨ Krytyczny |
| 15 | 0x8000 | Zabezpieczenie wyspy | Wykryto pracÄ™ wyspowÄ… | Auto-wyÅ‚Ä…czenie | ğŸš¨ Krytyczny |

### ALARM3 - Rejestr 32010 (0x7D0A)
**Opis:** Alarmy systemowe i komunikacji

| Bit | Maska | Alarm | Opis | Akcja | Priorytet |
|-----|-------|--------|------|--------|-----------|
| 0 | 0x0001 | BÅ‚Ä…d EEPROM | Uszkodzona pamiÄ™Ä‡ | SprawdÅº/wymieÅ„ EEPROM | ğŸš¨ Krytyczny |
| 1 | 0x0002 | BÅ‚Ä…d zegara RTC | NieprawidÅ‚owy czas | WymieÅ„ bateriÄ™ RTC | âš ï¸ WaÅ¼ny |
| 2 | 0x0004 | BÅ‚Ä…d kalibracji EEPROM | Uszkodzone dane kalibracji | Rekalibracja | âš ï¸ WaÅ¼ny |
| 3 | 0x0008 | BÅ‚Ä…d parametrÃ³w EEPROM | Uszkodzone parametry | Reset do fabrycznych | âš ï¸ WaÅ¼ny |
| 4 | 0x0010 | BÅ‚Ä…d komunikacji z licznikiem | Brak Å‚Ä…cznoÅ›ci | SprawdÅº RS485 | âš ï¸ WaÅ¼ny |
| 5 | 0x0020 | BÅ‚Ä…d komunikacji z optymalizatorami | Brak Å‚Ä…cznoÅ›ci | SprawdÅº PLC | âš ï¸ WaÅ¼ny |
| 6 | 0x0040 | BÅ‚Ä…d konfiguracji systemu | NieprawidÅ‚owa konfiguracja | SprawdÅº ustawienia | âš ï¸ WaÅ¼ny |
| 7 | 0x0080 | BÅ‚Ä…d firmware | Uszkodzone oprogramowanie | Aktualizuj firmware | ğŸš¨ Krytyczny |
| 8 | 0x0100 | BÅ‚Ä…d sprzÄ™tu | Awaria elementu hardware | Serwis techniczny | ğŸš¨ Krytyczny |
| 9 | 0x0200 | BÅ‚Ä…d systemu kontroli | Problem z mikrokontrolerem | Restart/serwis | ğŸš¨ Krytyczny |
| 10 | 0x0400 | BÅ‚Ä…d komunikacji RS485 | Problem z magistralÄ… | SprawdÅº okablowanie | âš ï¸ WaÅ¼ny |
| 11 | 0x0800 | BÅ‚Ä…d komunikacji CAN | Problem z CAN Bus | SprawdÅº CAN | âš ï¸ WaÅ¼ny |
| 12 | 0x1000 | BÅ‚Ä…d inicjalizacji | System siÄ™ nie uruchamia | Hard reset | ğŸš¨ Krytyczny |
| 13 | 0x2000 | BÅ‚Ä…d konfiguracji urzÄ…dzenia | NieprawidÅ‚owe ID/adres | SprawdÅº konfiguracjÄ™ | âš ï¸ WaÅ¼ny |
| 14 | 0x4000 | BÅ‚Ä…d aktualizacji firmware | Nieudana aktualizacja | PonÃ³w aktualizacjÄ™ | ğŸš¨ Krytyczny |
| 15 | 0x8000 | BÅ‚Ä…d krytyczny systemu | OgÃ³lny bÅ‚Ä…d krytyczny | Natychmiastowy serwis | ğŸš¨ Krytyczny |

---

## ğŸ”§ REJESTRY POMOCNICZE

### FAULT CODE - Rejestr 32090 (0x7D5A)
**Opis:** Numeryczny kod bÅ‚Ä™du (uzupeÅ‚nia alarmy bitowe)

| Kod | Opis | Akcja |
|-----|------|-------|
| 0x0000 | Brak bÅ‚Ä™dÃ³w | - |
| 0x0001-0x0999 | BÅ‚Ä™dy temperatury | SprawdÅº chÅ‚odzenie |
| 0x1000-0x1999 | BÅ‚Ä™dy napiÄ™cia | SprawdÅº sieÄ‡/PV |
| 0x2000-0x2999 | BÅ‚Ä™dy prÄ…du | SprawdÅº obciÄ…Å¼enie |
| 0x3000-0x3999 | BÅ‚Ä™dy izolacji | SprawdÅº instalacjÄ™ |
| 0x4000-0x4999 | BÅ‚Ä™dy komunikacji | SprawdÅº Å‚Ä…cznoÅ›Ä‡ |
| 0x5000-0x5999 | BÅ‚Ä™dy sprzÄ™towe | Serwis |
| 0x6000-0x6999 | BÅ‚Ä™dy oprogramowania | Aktualizacja |
| 0x7000-0x7999 | BÅ‚Ä™dy konfiguracji | SprawdÅº ustawienia |
| 0x8000-0x8999 | BÅ‚Ä™dy systemowe | Restart |
| 0x9000-0x9999 | BÅ‚Ä™dy krytyczne | Natychmiastowy serwis |

---

## ğŸ“ˆ ZALECENIA MONITOROWANIA

### Alarmy krytyczne (wymagajÄ… natychmiastowej reakcji):
- **Bit 12 w ALARM1:** Niska rezystancja izolacji
- **Bit 15 w ALARM1:** BÅ‚Ä…d AFCI (Å‚uk elektryczny)
- **Bit 8,9 w ALARM1:** OdwrÃ³cona polaryzacja PV
- **Bit 10,11 w ALARM1:** PV doziemiony
- **Bit 0,1,2 w ALARM1:** Wysoka temperatura
- **Bit 13,14,15 w ALARM2:** Zabezpieczenia napiÄ™cia/czÄ™stotliwoÅ›ci/wyspy

### Alarmy waÅ¼ne (wymagajÄ… kontroli w ciÄ…gu dnia):
- **Bit 3 w ALARM1:** BÅ‚Ä…d wentylatora
- **Bit 4,5,6 w ALARM1:** BÅ‚Ä™dy faz
- **Wszystkie czujniki w ALARM2:** BÅ‚Ä™dy pomiarowe

### Alarmy informacyjne (kontrola cotygodniowa):
- **STATE1:** Normalny cykl pracy
- **STATE3:** Status komunikacji
- **ALARM3:** BÅ‚Ä™dy komunikacji (jeÅ›li nie wpÅ‚ywajÄ… na pracÄ™)

### PrzykÅ‚adowy kod sprawdzania priorytetÃ³w:
```cpp
bool isCriticalAlarm = (alarm1 & 0x9F00) || (alarm2 & 0xE400) || (alarm3 & 0xC180);
bool isImportantAlarm = (alarm1 & 0x607F) || (alarm2 & 0x1BFF) || (alarm3 & 0x3E7F);
```

---

## ğŸ“Š PRZYKÅADY INTERPRETACJI

### PrzykÅ‚ad 1: Normalna praca w dzieÅ„
```
STATE1 = 0x00A4 (0000000010100100)
- Bit 2: PoÅ‚Ä…czenie z sieciÄ… âœ…
- Bit 5: Tryb eksportu energii âœ…  
- Bit 7: Tryb pracy âœ…
```

### PrzykÅ‚ad 2: Tryb nocny/standby
```
STATE1 = 0x0011 (0000000000010001)
- Bit 0: Standby â„¹ï¸
- Bit 4: Tryb oszczÄ™dzania energii â„¹ï¸
```

### PrzykÅ‚ad 3: Alarm krytyczny
```
ALARM1 = 0x1008 (0001000000001000)
- Bit 3: BÅ‚Ä…d wentylatora ğŸš¨
- Bit 12: Niska rezystancja izolacji ğŸš¨
```

---

## ğŸ› ï¸ NARZÄ˜DZIA DEBUGOWANIA

### Hex to Binary konwerter:
```bash
# PrzykÅ‚ad dla ALARM1 = 0x1008
echo "obase=2; ibase=16; 1008" | bc
# Wynik: 1000000001000
```

### Sprawdzanie konkretnego bitu:
```cpp
bool checkBit(uint16_t value, int bit) {
    return (value & (1 << bit)) != 0;
}
```

### Zliczanie aktywnych alarmÃ³w:
```cpp
int countActiveBits(uint16_t value) {
    return __builtin_popcount(value);
}
```

---

**Autor:** Tomek & Klaudia  
**Data utworzenia:** 18.06.2025  
**Wersja:** 1.0  
**Inverter:** Huawei SUN2000-8KTL-M1